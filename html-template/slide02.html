<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>Lichen: Visualization on the Web</title>
	
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["table","linechart"]});
  google.load("prototype", "1.6");
</script>
<script type="text/javascript" src="bioheatmap.js"></script>
<script language="JavaScript" type="text/javascript">	

	google.setOnLoadCallback(drawChart); // Set callback to run when API is loaded
	
function drawChart() {
			data = new google.visualization.DataTable();
            data.addColumn('string', 'Gene Name');
            data.addColumn('number', 'chip_XXX_XXX_600');
            data.addColumn('number', 'chip2');
            data.addColumn('number', 'chip3');
            data.addColumn('number', 'chip4');
            data.addColumn('number', 'chip5');
            data.addColumn('number', 'chip6');
            data.addRows(4);
            data.setCell(0, 0, 'ATF3');
            data.setCell(0, 1, 0);
            data.setCell(0, 2, 0.5);
            data.setCell(0, 3, 1);
            data.setCell(0, 4, 1.5);
            data.setCell(0, 5, 2);
            data.setCell(0, 6, 2.5);
            data.setCell(1, 0, 'INS');
            data.setCell(1, 1, 3);
            data.setCell(1, 2, 3.5);
            data.setCell(1, 3, 4);
            data.setCell(1, 4, 4.5);
            data.setCell(1, 5, 5);
            data.setCell(1, 6, 5.5);
            data.setCell(2, 0, 'TAP1');
            data.setCell(2, 1, 0);
            data.setCell(2, 2, null);
            data.setCell(2, 3, -1);
            data.setCell(2, 4, -1.5);
            data.setCell(2, 5, -2);
            data.setCell(2, 6, -2.5);
            data.setCell(3, 0, 'IL6');
            data.setCell(3, 1, -3);
            data.setCell(3, 2, -3.5);
            data.setCell(3, 3, -4);
            data.setCell(3, 4, -4.5);
            data.setCell(3, 5, -5);
            data.setCell(3, 6, -5.5);


            // Add more data rows and cells here
            heatmap = new org.systemsbiology.visualization.BioHeatMap(document.getElementById('heatmapdiv'));
            heatmap.draw(data, {selectionDisplay: {mode :  "flash", 
		        			fill:{color:{ r: 0, g: 0, b: 0, a: 0 }}, 
		        			border:{width:2,color:{ r:255, g:255, b: 0, a: .5 }}
		        			},
		        			cellWidth: 30,
                            cellHeight: 30});
                            

            // draw table
            table = new google.visualization.Table(document.getElementById("tablediv"));
            table.draw(data,{});

            google.visualization.events.addListener(table, 'select', function() {
                heatmap.setSelection(table.getSelection());
                drawLineChart();
            });
            google.visualization.events.addListener(heatmap, 'select', function() {
                table.setSelection(heatmap.getSelection());
                drawLineChart();
            });
      }
      
 function drawLineChart()
 {
 	if($("drawlinecharts").checked==false)
 	{
 		 return;
 	}
 	var selection = heatmap.getSelection();
 	var rows = [];
 	
 	for(var i = 0; i < selection.length; i++)
 	{
 		if('row' in selection[i])
 		{
 			rows.push(selection[i].row);
 		}
 	}
 	
 	var chartdata = new google.visualization.DataView(data);
 	chartdata.setRows(rows);
 	document.getElementById('linechartdiv').innerHTML="";
 	var chart = new google.visualization.LineChart(document.getElementById('linechartdiv'));
   	chart.draw(chartdata, {width: 200, height: 240, legend: 'bottom'});
    
 	
 	
 }

	
</script>

<style>
body { margin: 30px; text-align: center;}
</style>

</head>

<body scroll="no">
	<table>
	<tr>
	<td>
	<div id="heatmapdiv"></div>
	</td>
	<td>
	<div id="linechartdiv"></div>
	</td>
	</tr>
	</table>
	<br/>
	<INPUT TYPE="CHECKBOX" id="drawlinecharts"/> Draw Line Charts
	<br/><br/>
	<div id="tablediv"></div><br/>
	Our heatmap can be set up to share events and selection information with other visualizations. <br/>
	<a href="slide01.html">previous</a> &nbsp&nbsp<a href="slide03.html">next</a>


	
</body>
</html>